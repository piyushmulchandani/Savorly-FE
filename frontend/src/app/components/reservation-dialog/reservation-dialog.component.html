<h2 mat-dialog-title>Make Reservation</h2>

<mat-dialog-content>
	<form [formGroup]="reservationForm">
		<div class="form-grid">
			<mat-form-field appearance="outline">
				<mat-label>Date</mat-label>
				<input matInput [matDatepicker]="picker" formControlName="date" [min]="today" (ngModelChange)="onFilterChange()" />
				<mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
				<mat-datepicker #picker></mat-datepicker>
			</mat-form-field>

			<mat-form-field appearance="outline">
				<mat-label>Number of People</mat-label>
				<input matInput type="number" formControlName="people" min="1" max="20" (ngModelChange)="onFilterChange()" />
			</mat-form-field>
		</div>

		<button
			mat-flat-button
			(click)="checkAvailability()"
			[disabled]="reservationForm.get('date')?.invalid || reservationForm.get('people')?.invalid">
			Check Availability
		</button>

		<div *ngIf="loading" class="spinner-container">
			<mat-spinner diameter="30"></mat-spinner>
		</div>

		<div *ngIf="availableTimes.length > 0" class="times-container">
			<h3>Available Times</h3>
			<div class="time-buttons">
				<button *ngFor="let time of availableTimes" mat-stroked-button (click)="selectTime(time)" [class.selected]="isTimeSelected(time)">
					{{ time }}
				</button>
			</div>
		</div>
	</form>
</mat-dialog-content>

<mat-dialog-actions align="end">
	<button mat-button mat-dialog-close>Cancel</button>
	<button mat-flat-button (click)="submitReservation()" [disabled]="reservationForm.invalid || loading">Confirm</button>
</mat-dialog-actions>
