<div class="container" *ngIf="authorized">
	<div class="back-button-container">
		<button mat-stroked-button color="primary" (click)="goBack()">
			<mat-icon>arrow_back</mat-icon>
			Back
		</button>
	</div>
	<div *ngIf="loading" class="loading-container">
		<mat-spinner color="primary"></mat-spinner>
		<p>Loading table information...</p>
	</div>

	<div *ngIf="!loading && !table" class="error-container">
		<mat-icon>error</mat-icon>
		<p>There was an error loading the table information.</p>
	</div>

	<div *ngIf="!loading && table" class="table-view-container">
		<mat-card>
			<mat-card-header>
				<mat-card-title>Table #{{ table.tableNumber }}</mat-card-title>
				<mat-card-subtitle> Capacity: {{ table.minPeople }} - {{ table.maxPeople }} people </mat-card-subtitle>
				<div class="action-buttons">
					<button *ngIf="table.occupied" mat-flat-button color="primary" (click)="openOrderDialog()">
						<mat-icon>add_shopping_cart</mat-icon>
						Create Order
					</button>
				</div>
			</mat-card-header>

			<mat-card-content>
				<div *ngIf="!table.occupied" class="unoccupied-container">
					<div class="table-status available">
						<mat-icon>check_circle</mat-icon>
						<span>Available</span>
					</div>

					<button mat-raised-button color="primary" (click)="occupyTable()">
						<mat-icon>person_add</mat-icon>
						Occupy Table
					</button>
				</div>

				<!-- View for occupied tables -->
				<div *ngIf="table.occupied" class="occupied-container">
					<div class="table-status occupied">
						<mat-icon>people</mat-icon>
						<span>Currently Occupied</span>
					</div>

					<app-orders
						*ngIf="table"
						[restaurantId]="this.restaurantId"
						[tableId]="this.tableId"
						[tableNumber]="this.table.tableNumber"></app-orders>

					<div class="cost-summary">
						<h3>Table Total</h3>
						<p class="total-cost">{{ table.currentCost }}â‚¬</p>
					</div>

					<button mat-raised-button color="accent" (click)="completeTableService()">
						<mat-icon>check</mat-icon>
						Complete Table Service
					</button>
				</div>
			</mat-card-content>
		</mat-card>
	</div>
</div>

<div *ngIf="!authorized && !loading" class="unauthorized-container">
	<mat-icon>lock</mat-icon>
	<h2>Unauthorized Access</h2>
	<p>You don't have permission to view this table.</p>
</div>
